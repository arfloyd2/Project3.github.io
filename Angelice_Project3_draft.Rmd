---
title: "Angelice_Project3 Education Level: `r params$edlvl` "
author: "Angelice Floyd"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r rndr, eval = FALSE, echo = FALSE}

lapply(c(1,3,4,5,6),function(x) {rmarkdown::render("Angelice_Project3_draft.Rmd",
              output_format = "github_document", 
              output_options = list(
                name_value_pairs = "value", 
                toc = TRUE,
                toc_depth = 4, 
                number_of_sections = TRUE, 
                df_print = "paged", 
                or_something = TRUE,
                html_preview = FALSE,
                params = list(edlvl = x),
                output_file = paste0("Project3",x,".HTML")
                
                )
              )
}
)
```


Introduction : Insert Michael's intro here 

```{r libraries}

library(tidyverse)
library(caret)
library(GGally)
library(shiny)
```


# Reading in the Data 

Below reads in the binary heart disease data, converts the appropriate variables into factor level variables, and splits the data into training and test set data. 

```{r readin, message = FALSE}
initial_dta <- read_csv('diabetes_binary_health_indicators_BRFSS2015.csv') %>% mutate( Education1 = ifelse(Education %in% c(1,2),1,Education)) %>% filter(Education1 == params$edlvl)


cols <- c("Diabetes_binary","PhysActivity","AnyHealthcare","Education1","HighBP",
          "Smoker","Fruits","NoDocbcCost","Income","DiffWalk","HighChol","Stroke",
          "Veggies","GenHlth","Sex","CholCheck","HeartDiseaseorAttack","HvyAlcoholConsump",
          "MentHlth")
  
initial_dta[cols] <- lapply(initial_dta[cols],factor)

#set seed for reproducability 

set.seed(90)

#create a training index that uses 70% of the data for training data

trainindex <- createDataPartition(initial_dta$Diabetes_binary,p = 0.70, list= FALSE)

#Now, split the data into 70% training and 30% testing

initial_dta_train <- initial_dta[trainindex, ]
initial_dta_test <- initial_dta[-trainindex, ]

#To help make our predictions valid, we are now going to standardize the numeric variables

preprocval <- preProcess(initial_dta_train,method = c("center","scale"))

trainTransformed <- as_tibble(predict(preprocval,initial_dta_train))


testTransformed <- as_tibble(predict(preprocval,initial_dta_test))

```

# Exploratory Data Analysis 

Because this data is in binary form, contingency tables and categorical visuals will be helpful since it will show how the different levels of those with and without diabetes compare to each other over levels of other categorical variables or how values for the numerical variables conpare at different levels for those with or without diabetes. 

## Frequency of Diabetes Patients and Pre-Existing Conditions 

This frequency table will show the number of patients with and without diabetes who have( or do not have) high blood pressure, high cholestroral, have had stroke or have had a heart attack or heart disease.  

```{r healthconcerns}


BP <- data.frame(table(initial_dta$Diabetes_binary,initial_dta$HighBP)) %>% rename(Diabetes_binary="Var1", High_BP = "Var2", BP_Freq = "Freq")
#CHOL <- data.frame(table(initial_dta$Diabetes_binary, initial_dta$HighChol,initial_dta$params$edlvl)) %>% rename(Diabetes_binary="Var1", High_Chol = "Var2", HI_CHOL_Freq = "Freq" )
#STRKE <- as.data.frame(table(initial_dta$Diabetes_binary, initial_dta$Stroke,initial_dta$params$edlvl)) %>% rename(Diabetes_binary="Var1", Stroke = "Var2", sTROKE_Freq = "Freq" )
#HATCK <- as.data.frame(table(initial_dta$Diabetes_binary, initial_dta$HeartDiseaseorAttack,initial_dta$params$edlvl)) %>% rename(Diabetes_binary="Var1", Heart_Disease_Attack = "Var2", Heart_Disease_Attack_Freq = "Freq" )

#Diabetes_disease_frequency <- list("BP" = BP,"CHOL" = CHOL,"STRKE" = STRKE,"HATCK" = HATCK)

BP

```